<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selector de Rango de Fechas - Calendario Interactivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
        }

        .calendar-container {
            flex: 1;
            min-width: 300px;
            max-width: 800px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .controls-container {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 25px;
        }

        .calendar-header {
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .month-year {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background-color: #f8f9fa;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .weekday {
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
        }

        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #eee;
            padding: 1px;
            min-height: 350px;
        }

        .day {
            background-color: white;
            padding: 12px 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .day:hover {
            background-color: #f0f7ff;
        }

        .day.other-month {
            color: #bdc3c7;
            background-color: #f9f9f9;
        }

        .day.selected {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }

        .day.in-range {
            background-color: #e1f0fa;
        }

        .day.start-date::after, .day.end-date::after {
            content: '';
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #e74c3c;
        }

        .day.start-date {
            background-color: #3498db;
            color: white;
            border-top-left-radius: 50%;
            border-bottom-left-radius: 50%;
        }

        .day.end-date {
            background-color: #3498db;
            color: white;
            border-top-right-radius: 50%;
            border-bottom-right-radius: 50%;
        }

        .current-day {
            border: 2px solid #e74c3c;
        }

        .time-selectors {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .time-selector {
            flex: 1;
            min-width: 150px;
        }

        .time-selector h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .time-inputs {
            display: flex;
            gap: 10px;
        }

        .time-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }

        .selected-range {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 25px;
        }

        .selected-range h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .selected-range h3 i {
            color: #3498db;
        }

        .range-display {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .range-item {
            flex: 1;
            min-width: 150px;
        }

        .range-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .range-value {
            font-size: 1.2rem;
            color: #2c3e50;
            font-weight: 600;
            padding: 8px 12px;
            background-color: white;
            border-radius: 6px;
            border: 1px solid #eee;
        }

        .actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-secondary {
            background-color: #ecf0f1;
            color: #2c3e50;
        }

        .btn-secondary:hover {
            background-color: #d5dbdb;
        }

        .instructions {
            margin-top: 25px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .instructions h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions ul {
            padding-left: 20px;
            color: #555;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .calendar-container, .controls-container {
                max-width: 100%;
            }
            
            .days-grid {
                min-height: 300px;
            }
            
            .day {
                padding: 10px 3px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-calendar-alt"></i> Selector de Rango de Fechas</h1>
            <p class="subtitle">Calendario en español latinoamericano con selección de fecha y hora de inicio/fin</p>
        </header>

        <div class="app-container">
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="month-year" id="month-year">Enero 2023</div>
                    <div class="nav-buttons">
                        <button class="nav-btn" id="prev-year" title="Año anterior">
                            <i class="fas fa-angle-double-left"></i>
                        </button>
                        <button class="nav-btn" id="prev-month" title="Mes anterior">
                            <i class="fas fa-angle-left"></i>
                        </button>
                        <button class="nav-btn" id="today-btn" title="Ir a hoy">
                            Hoy
                        </button>
                        <button class="nav-btn" id="next-month" title="Mes siguiente">
                            <i class="fas fa-angle-right"></i>
                        </button>
                        <button class="nav-btn" id="next-year" title="Año siguiente">
                            <i class="fas fa-angle-double-right"></i>
                        </button>
                    </div>
                </div>

                <div class="weekdays">
                    <div class="weekday">Dom</div>
                    <div class="weekday">Lun</div>
                    <div class="weekday">Mar</div>
                    <div class="weekday">Mié</div>
                    <div class="weekday">Jue</div>
                    <div class="weekday">Vie</div>
                    <div class="weekday">Sáb</div>
                </div>

                <div class="days-grid" id="calendar-days">
                    <!-- Days will be generated by JavaScript -->
                </div>
            </div>

            <div class="controls-container">
                <div class="time-selectors">
                    <div class="time-selector">
                        <h3><i class="far fa-clock"></i> Hora de inicio</h3>
                        <div class="time-inputs">
                            <input type="time" id="start-time" class="time-input" value="09:00">
                        </div>
                    </div>
                    <div class="time-selector">
                        <h3><i class="far fa-clock"></i> Hora de fin</h3>
                        <div class="time-inputs">
                            <input type="time" id="end-time" class="time-input" value="17:00">
                        </div>
                    </div>
                </div>

                <div class="selected-range">
                    <h3><i class="fas fa-calendar-check"></i> Rango seleccionado</h3>
                    <div class="range-display">
                        <div class="range-item">
                            <div class="range-label">Fecha de inicio</div>
                            <div class="range-value" id="display-start-date">-</div>
                        </div>
                        <div class="range-item">
                            <div class="range-label">Fecha de fin</div>
                            <div class="range-value" id="display-end-date">-</div>
                        </div>
                    </div>
                    <div class="range-display" style="margin-top: 15px;">
                        <div class="range-item">
                            <div class="range-label">Duración</div>
                            <div class="range-value" id="display-duration">-</div>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn btn-secondary" id="clear-btn">
                        <i class="fas fa-eraser"></i> Limpiar selección
                    </button>
                    <button class="btn btn-primary" id="apply-btn">
                        <i class="fas fa-check-circle"></i> Aplicar rango
                    </button>
                </div>

                <div class="instructions">
                    <h4><i class="fas fa-info-circle"></i> Instrucciones de uso</h4>
                    <ul>
                        <li>Haz clic en una fecha para establecer la fecha de inicio</li>
                        <li>Haz clic en otra fecha para establecer la fecha de fin</li>
                        <li>Las fechas intermedias se seleccionarán automáticamente</li>
                        <li>Ajusta las horas de inicio y fin usando los selectores de tiempo</li>
                        <li>Usa los botones de navegación para cambiar de mes/año</li>
                    </ul>
                </div>
            </div>
        </div>

        <footer>
            <p>Calendario en español latinoamericano | Componente de selección de rango de fechas</p>
        </footer>
    </div>

    <script>
        // Spanish localization for Latin America
        const esLocale = {
            months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                    'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            weekdaysShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'],
            today: 'Hoy',
            clear: 'Limpiar',
            apply: 'Aplicar'
        };

        // Calendar state
        let currentDate = new Date();
        let startDate = null;
        let endDate = null;
        let selectingStart = true;

        // DOM elements
        const monthYearElement = document.getElementById('month-year');
        const calendarDaysElement = document.getElementById('calendar-days');
        const startTimeElement = document.getElementById('start-time');
        const endTimeElement = document.getElementById('end-time');
        const displayStartDateElement = document.getElementById('display-start-date');
        const displayEndDateElement = document.getElementById('display-end-date');
        const displayDurationElement = document.getElementById('display-duration');
        const todayButton = document.getElementById('today-btn');
        const prevMonthButton = document.getElementById('prev-month');
        const nextMonthButton = document.getElementById('next-month');
        const prevYearButton = document.getElementById('prev-year');
        const nextYearButton = document.getElementById('next-year');
        const clearButton = document.getElementById('clear-btn');
        const applyButton = document.getElementById('apply-btn');

        // Initialize calendar
        function initCalendar() {
            renderCalendar();
            updateDisplay();
            setupEventListeners();
        }

        // Render calendar for current month
        function renderCalendar() {
            // Clear previous days
            calendarDaysElement.innerHTML = '';

            // Set month and year in header
            const month = currentDate.getMonth();
            const year = currentDate.getFullYear();
            monthYearElement.textContent = `${esLocale.months[month]} ${year}`;

            // Get first day of month and total days in month
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const totalDays = lastDay.getDate();
            const firstDayIndex = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.

            // Get today's date for comparison
            const today = new Date();
            const isToday = (day) => {
                return day === today.getDate() && 
                       month === today.getMonth() && 
                       year === today.getFullYear();
            };

            // Get previous month's last days
            const prevMonthLastDay = new Date(year, month, 0).getDate();

            // Add days from previous month
            for (let i = firstDayIndex; i > 0; i--) {
                const day = prevMonthLastDay - i + 1;
                const dayElement = createDayElement(day, true, false, false, false);
                calendarDaysElement.appendChild(dayElement);
            }

            // Add days from current month
            for (let day = 1; day <= totalDays; day++) {
                const date = new Date(year, month, day);
                const isSelected = isDateSelected(date);
                const isInRange = isDateInRange(date);
                const isStart = startDate && date.toDateString() === startDate.toDateString();
                const isEnd = endDate && date.toDateString() === endDate.toDateString();
                
                const dayElement = createDayElement(
                    day, 
                    false, 
                    isToday(day), 
                    isSelected, 
                    isInRange, 
                    isStart, 
                    isEnd
                );
                
                dayElement.addEventListener('click', () => selectDate(date));
                calendarDaysElement.appendChild(dayElement);
            }

            // Add days from next month to fill the grid
            const totalCells = 42; // 6 weeks * 7 days
            const nextMonthDays = totalCells - (firstDayIndex + totalDays);
            
            for (let day = 1; day <= nextMonthDays; day++) {
                const dayElement = createDayElement(day, true, false, false, false);
                calendarDaysElement.appendChild(dayElement);
            }
        }

        // Create a day element for the calendar
        function createDayElement(day, isOtherMonth, isToday, isSelected, isInRange, isStart = false, isEnd = false) {
            const dayElement = document.createElement('div');
            dayElement.className = 'day';
            dayElement.textContent = day;

            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            }

            if (isToday) {
                dayElement.classList.add('current-day');
            }

            if (isSelected) {
                dayElement.classList.add('selected');
            }

            if (isInRange) {
                dayElement.classList.add('in-range');
            }

            if (isStart) {
                dayElement.classList.add('start-date');
            }

            if (isEnd) {
                dayElement.classList.add('end-date');
            }

            return dayElement;
        }

        // Check if a date is selected (start or end)
        function isDateSelected(date) {
            if (!startDate && !endDate) return false;
            
            const dateString = date.toDateString();
            const startString = startDate ? startDate.toDateString() : null;
            const endString = endDate ? endDate.toDateString() : null;
            
            return dateString === startString || dateString === endString;
        }

        // Check if a date is in the selected range
        function isDateInRange(date) {
            if (!startDate || !endDate) return false;
            
            const dateTime = date.getTime();
            const startTime = startDate.getTime();
            const endTime = endDate.getTime();
            
            // Swap if start is after end
            const actualStart = Math.min(startTime, endTime);
            const actualEnd = Math.max(startTime, endTime);
            
            return dateTime > actualStart && dateTime < actualEnd;
        }

        // Handle date selection
        function selectDate(date) {
            // Combine date with selected time
            const startTime = startTimeElement.value.split(':');
            const endTime = endTimeElement.value.split(':');
            
            const selectedDate = new Date(date);
            
            if (selectingStart || (!startDate && !endDate)) {
                // Set start date
                startDate = new Date(selectedDate);
                startDate.setHours(parseInt(startTime[0]), parseInt(startTime[1]));
                selectingStart = false;
            } else {
                // Set end date
                endDate = new Date(selectedDate);
                endDate.setHours(parseInt(endTime[0]), parseInt(endTime[1]));
                selectingStart = true;
                
                // If end date is before start date, swap them
                if (endDate < startDate) {
                    [startDate, endDate] = [endDate, startDate];
                }
            }
            
            renderCalendar();
            updateDisplay();
        }

        // Update the display of selected range
        function updateDisplay() {
            const formatDateTime = (date) => {
                if (!date) return '-';
                
                return date.toLocaleDateString('es-ES', {
                    weekday: 'short',
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };

            const calculateDuration = () => {
                if (!startDate || !endDate) return '-';
                
                const diffMs = Math.abs(endDate - startDate);
                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
                
                let duration = '';
                if (diffDays > 0) duration += `${diffDays} día${diffDays !== 1 ? 's' : ''} `;
                if (diffHours > 0) duration += `${diffHours} hora${diffHours !== 1 ? 's' : ''} `;
                if (diffMinutes > 0 || (diffDays === 0 && diffHours === 0)) {
                    duration += `${diffMinutes} minuto${diffMinutes !== 1 ? 's' : ''}`;
                }
                
                return duration.trim();
            };

            displayStartDateElement.textContent = formatDateTime(startDate);
            displayEndDateElement.textContent = formatDateTime(endDate);
            displayDurationElement.textContent = calculateDuration();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Navigation buttons
            todayButton.addEventListener('click', () => {
                currentDate = new Date();
                renderCalendar();
            });

            prevMonthButton.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });

            nextMonthButton.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });

            prevYearButton.addEventListener('click', () => {
                currentDate.setFullYear(currentDate.getFullYear() - 1);
                renderCalendar();
            });

            nextYearButton.addEventListener('click', () => {
                currentDate.setFullYear(currentDate.getFullYear() + 1);
                renderCalendar();
            });

            // Time inputs
            startTimeElement.addEventListener('change', () => {
                if (startDate) {
                    const time = startTimeElement.value.split(':');
                    startDate.setHours(parseInt(time[0]), parseInt(time[1]));
                    updateDisplay();
                }
            });

            endTimeElement.addEventListener('change', () => {
                if (endDate) {
                    const time = endTimeElement.value.split(':');
                    endDate.setHours(parseInt(time[0]), parseInt(time[1]));
                    updateDisplay();
                }
            });

            // Action buttons
            clearButton.addEventListener('click', () => {
                startDate = null;
                endDate = null;
                selectingStart = true;
                renderCalendar();
                updateDisplay();
            });

            applyButton.addEventListener('click', () => {
                if (startDate && endDate) {
                    alert(`Rango de fechas aplicado:\nDesde: ${startDate.toLocaleString('es-ES')}\nHasta: ${endDate.toLocaleString('es-ES')}`);
                } else {
                    alert('Por favor, selecciona un rango de fechas primero.');
                }
            });
        }

        // Initialize the calendar when the page loads
        document.addEventListener('DOMContentLoaded', initCalendar);
    </script>
</body>
</html>